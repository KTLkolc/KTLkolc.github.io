<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- 在<head>部分添加Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>纸上谈兵 - 游戏进行中</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#FF7D00',
                        accent: '#FF4D4F',
                        dark: '#1D2129',
                        light: '#F2F3F5'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-dark to-primary min-h-screen font-inter text-light overflow-x-hidden">
    <!-- 游戏界面内容 -->
    <div id="game-container" class="relative min-h-screen flex flex-col items-center justify-center px-4 py-8 z-10">
        <h1 class="text-3xl font-bold text-white mb-4">游戏房间: <span id="current-room-id"></span></h1>
        <div id="players-list" class="w-full max-w-md bg-white/10 backdrop-blur-xl rounded-xl p-4 mb-6">
            <!-- 玩家列表将在这里动态生成 -->
        </div>
        <div id="game-board" class="w-full max-w-2xl bg-white/10 backdrop-blur-xl rounded-xl p-6">
            <!-- 游戏棋盘将在这里渲染 -->
        </div>
    </div>

    <script>
        // 初始化Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD3j5Jz5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5Z5",
            authDomain: "paper-strategy-game.firebaseapp.com",
            projectId: "paper-strategy-game",
            storageBucket: "paper-strategy-game.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdefghijklmnopqrstuv"
        };
        
        // 初始化Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // 匿名登录
        auth.signInAnonymously()
            .then(() => {
                console.log("匿名登录成功");
            })
            .catch((error) => {
                console.error("匿名登录失败:", error);
            });
        
        // 获取房间ID
        const urlParams = new URLSearchParams(window.location.search);
        const roomId = urlParams.get('roomId');
        
        if (!roomId) {
            alert('无效的房间ID');
            window.location.href = 'index.html';
        }
        
        document.getElementById('current-room-id').textContent = roomId;
        
        // 监听房间状态
        const roomRef = db.collection('rooms').doc(roomId);
        
        roomRef.onSnapshot((doc) => {
            const roomData = doc.data();
            
            if (!roomData) {
                alert('房间已不存在');
                window.location.href = 'index.html';
                return;
            }
            
            // 更新玩家列表
            updatePlayersList(roomData.players || []);
            
            // 根据游戏状态更新界面
            if (roomData.status === 'playing') {
                renderGameBoard(roomData.gameState);
            }
        });
        
        function updatePlayersList(players) {
            const playersList = document.getElementById('players-list');
            playersList.innerHTML = '<h3 class="text-xl font-semibold text-white mb-4">玩家列表</h3>';
            
            players.forEach(player => {
                const playerElement = document.createElement('div');
                playerElement.className = 'flex items-center py-2 border-b border-white/10 last:border-0';
                playerElement.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-${player.ready ? 'green' : 'red'}-500/20 flex items-center justify-center mr-3">
                        <i class="fa fa-${player.ready ? 'check' : 'user'} text-xs"></i>
                    </div>
                    <span class="font-medium">${player.name}</span>
                `;
                playersList.appendChild(playerElement);
            });
        }
        
        function renderGameBoard(gameState) {
            // 根据你的游戏逻辑实现棋盘渲染
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '<h3 class="text-xl font-semibold text-white mb-4">游戏进行中</h3>';
            
            // 这里添加你的游戏逻辑和UI
        }
    </script>
</body>
</html>
